ç¯å¢ƒï¼šDeBian 11.3

å‚è€ƒ[åœ¨ Linux ä¸‹ä½¿ç”¨ Clash è¿›è¡Œå…¨å±€ä¸Šç½‘ä»£ç†åŠè‡ªåŠ¨è®¢é˜…ä»£ç†å’Œè§„åˆ™ - è–¯æ¡çš„åšå®¢ (robinxb.com)](https://robinxb.com/posts/2023/clash-on-linux/)
## å‡†å¤‡å·¥ä½œ

1.  ä»ä»¥ä¸‹å¤‡ä»½åº“ä¸‹è½½ Clash Premium:

    ç”±äº Clash Premium çš„ä¸»åº“å·²è¢«åˆ é™¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å¤‡ä»½åº“æ¥è·å–å§ã€‚  
    [Clash-premium-backup](https://github.com/zhongfly/Clash-premium-backup/releases/download/2023-09-05-gdcc8d87/clash-linux-amd64-n2023-09-05-gdcc8d87.gz)

## å®‰è£…å’Œé…ç½®

1.  è§£å‹ä¸‹è½½çš„æ–‡ä»¶ï¼š

```bash
gzip -d clash-linux-amd64-n2023-09-05-gdcc8d87.gz
chmod +x clash-linux-amd64
mv clash-linux-amd64 clash
```

2.  åˆ›å»ºé…ç½®æ–‡ä»¶ config.yamlï¼Œå¹¶ç¼–è¾‘é…ç½®ï¼š

æˆ‘è¿™é‡Œç›´æ¥æŠŠwindowsæœºåœºçš„é…ç½®æ–‡ä»¶æ‹·è¿‡æ¥äº†ï¼Œç„¶åæ”¹åä¸ºconfig.yamlã€‚

## æµ‹è¯•å’Œè¿è¡Œ

**è¿è¡Œ Clash:**

```
./clash -f /path/to/your/config.yml 
```

æ³¨æ„ï¼šè¯·æ›¿æ¢Â `/path/to/your/config.yml`Â ä¸ºä½ çš„å®é™…é…ç½®æ–‡ä»¶è·¯å¾„ã€‚

### åˆæ¬¡è¿è¡Œ
```bash
rezzo@iZmhZ:~/ClashforLinux$ ./clash -f config.yml 
17:21:30 INF [MMDB] can't find DB, start download path=/home/rezzo/.config/clash/Country.mmdb
17:22:00 FTL [Config] initial configuration directory error=can't initial MMDB: can't download MMDB: Get "https://cdn.jsdelivr.net/gh/Dreamacro/maxmind-geoip@release/Country.mmdb": dial tcp 93.46.8.90:443: i/o timeout path=/home/rezzo/.config/clash
```
æŠ¥é”™ï¼Œç½‘ç»œé—®é¢˜ï¼Œæ‰‹åŠ¨åœ¨å…¶ä»–ç»ˆç«¯ç”¨ä¸Šé¢çš„cdnçš„åœ°å€ä¸‹è½½å®Œæˆåï¼Œæ”¾å…¥/home/rezzo/.config/clash/Country.mmdbä»–è¯´çš„ä½ç½®ã€‚

### å†æ¬¡è¿è¡Œ
```bash
rezzo@iZmh4Z:~/ClashforLinux$ ls
clash  config.yml  update-config.sh
rezzo@iZmh40dsro8b12Z:~/ClashforLinux$ ./clash -f config.yml 
17:25:28 INF [Config] initial compatible provider name=â™»ï¸ è‡ªåŠ¨é€‰æ‹©
17:25:28 INF [Config] initial compatible provider name=ğŸŒ å›½å†…åª’ä½“
```
æˆåŠŸåŠ è½½é…ç½®
### è‡ªåŠ¨æ›´æ–°æœºåœºé…ç½®æ–‡ä»¶
```bash
rezzo@iZmh40:~/ClashforLinux$ cat update-config.sh 
#!/bin/bash

# æ›¿æ¢ä¸ºä½ çš„ Clash å¤–éƒ¨æ§åˆ¶å™¨åœ°å€å’Œç«¯å£
CLASH_API="http://127.0.0.1:9090"

# æ›¿æ¢ä¸ºä½ çš„é…ç½®æ–‡ä»¶ URL
CONFIG_URL="ä½ çš„ï¼æ­£è§„åˆæ³•ï¼æœºåœºé…ç½®æ–‡ä»¶ä¸‹è½½åœ°å€"

# ä¸‹è½½æœ€æ–°çš„é…ç½®æ–‡ä»¶
curl -s -o config.yml "$CONFIG_URL"

# ä½¿ç”¨ Clash API æ›´æ–°é…ç½®
curl -s -X PUT --data-binary @config.yml -H "Content-Type: application/x-yml" "$CLASH_API/configs?force=true"
```
## æµ‹è¯•ä»£ç†
ç°åœ¨åº”è¯¥å¯ä»¥é€šè¿‡ä»£ç†ç«¯å£è®¿é—®äº†
```
curl -x http://127.0.0.1:7890 -L google.com
```
å¦‚æœç›´æ¥è®¿é—®è€Œä¸èµ°ä»£ç†ç«¯å£æ˜¯æ— æ³•è®¿é—®çš„

## clashå¼€æœºè‡ªå¯å’Œå®šæ—¶æ›´æ–°é…ç½®æ–‡ä»¶
**clashå¼€æœºè‡ªå¯**

æ·»åŠ æœåŠ¡
```
sudo vim /etc/systemd/system/clash.service
```
å¦‚ä¸‹å¡«å†™
```
[Unit]
Description=Clash Proxy Service
After=network.target

[Service]
Type=simple
User=ä½ çš„ç”¨æˆ·å
ExecStart=/è·¯å¾„/to/clash -f /è·¯å¾„/to/config.yml
Restart=on-failure
RestartSec=3

[Install]
WantedBy=multi-user.target
```
å¯ç”¨æœåŠ¡
```
sudo systemctl start clash
sudo systemctl enable clash
```
**æ›´æ–°é…ç½®æ–‡ä»¶å®šæ—¶ä»»åŠ¡**
```
crontab -e
```
æ·»åŠ å¦‚å‡Œæ™¨3ç‚¹æ›´æ–°
```
0 3 * * * /è·¯å¾„/to/update-config.sh
```
## ç³»ç»Ÿä»£ç†åº”ç”¨ä»£ç†è‡ªè¡Œæœç´¢
# æ³¨æ„äº‹é¡¹
1.  ç¡®ä¿éµå®ˆæ‚¨æ‰€åœ¨åœ°åŒºçš„æ³•å¾‹æ³•è§„ã€‚
1.  ä»£ç†æœåŠ¡å™¨çš„ä½¿ç”¨åº”å‡ºäºåˆæ³•å’Œæ­£å½“ç›®çš„ã€‚
1.  æœ¬æ•™ç¨‹ä»…ä¾›æ•™è‚²å’Œå­¦ä¹ äº¤æµï¼Œè¯·å‹¿ç”¨äºéæ³•æ´»åŠ¨ã€‚
